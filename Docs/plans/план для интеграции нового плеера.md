# План настройки приложения для поддержки HTTP-стримов

## 1. Настройка для Android:

### Шаги по настройке:

1. **Подготовка к изменениям в Android Manifest**:
   - Создание необходимой директории для конфигурации сети
   - Создание файла network_security_config.xml
   - Модификация app.json для Expo или AndroidManifest.xml напрямую

2. **Содержимое network_security_config.xml**:
   ```xml
   <?xml version="1.0" encoding="utf-8"?>
   <network-security-config>
     <base-config cleartextTrafficPermitted="true">
       <trust-anchors>
         <certificates src="system" />
       </trust-anchors>
     </base-config>
   </network-security-config>
   ```

3. **Модификация app.json для Expo**:
   ```json
   {
     "expo": {
       ...
       "android": {
         ...
         "networkSecurityConfig": "./network_security_config.xml",
         "usesCleartextTraffic": true
       }
     }
   }
   ```

## 2. Настройка для iOS:

### Шаги по настройке:

1. **Модификация app.json для Expo**:
   ```json
   {
     "expo": {
       ...
       "ios": {
         ...
         "infoPlist": {
           "NSAppTransportSecurity": {
             "NSAllowsArbitraryLoads": true
           }
         }
       }
     }
   }
   ```

## 3. Тестирование изменений:

1. **Локальное тестирование**:
   - Сборка приложения с новыми настройками
   - Проверка работы HTTP-стримов на тестовом устройстве

2. **Отладка возможных проблем**:
   - Проверка логов для выявления ошибок сборки
   - Анализ сгенерированных манифестов

## 4. Стратегия, если возникают ошибки сборки:

1. **Пошаговое внесение изменений**:
   - Сначала только usesCleartextTraffic
   - Затем добавление networkSecurityConfig
   - Отдельное тестирование каждого изменения

2. **Альтернативные пути настройки**:
   - Использование expo-dev-client для большего контроля над нативными настройками
   - Возможный "ejection" из Expo для прямого доступа к нативному коду

## 5. Обработка ошибок на стороне пользователя:

1. **Добавление информативных сообщений**:
   - Уведомление пользователя о возможных проблемах с HTTP-стримами
   - Инструкции по настройке устройства, если это необходимо

## 6. Соблюдение политик магазинов приложений:

1. **Документирование причин использования HTTP**:
   - Подготовка объяснения для App Store Review
   - Обоснование, почему HTTP необходим (отсутствие HTTPS на источниках)
